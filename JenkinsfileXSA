@Library('piper-library-os') _
node() {
    stage('prepare') {
        checkout scm
        setupCommonPipelineEnvironment script:this, configFile: '.pipeline/configXSA.yml'
    }
    stage('Build') {
        mtaBuild script: this
    }
    stage('deploy') {
        dockerExecute(dockerImage: 'alunde/xsa-cli') {
          sh "xs api"
          sh "xs api https://api.parvus.lcfx.net:443 --skip-ssl-validation"
          sh "xs l -u XSA_ADMIN -p Plak8484 -o lcfx -s DEV"
          sh "xs a"
          sh "echo 'mtarFileName'"
          sh "echo ${PATH}"
          sh "echo commonPipelineEnvironment.configuration.general.gitSshKeyCredentialsId"
          sh "echo ${commonPipelineEnvironment.configuration.general.gitSshKeyCredentialsId}"
        }
        mailSendNotification script: this
    }
}